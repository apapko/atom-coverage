sudo: false
language: node_js
node_js:
- '8'
- '6'
cache:
  yarn: true
  directories:
  - node_modules
stages:
- test
- name: release
  if: branch = master
install:
- yarn install --ignore-engines
script:
- >
  echo "Running tests against $(node -v) ..." &&
  commitlint-travis &&
  run-p lint:* &&
  npm run test:unit &&
  npm run test:integration &&
  npm run test:functional &&
  npm run test:acceptance &&
  npm run test:coverage &&
  run-p check:*

jobs:
  include:
  - stage: release
    node_js: lts/*
    script: skip
    deploy:
      provider: script
      skip_cleanup: true
      script:
      - semantic-release
env:
  global:
  - secure: g5y/cEW4FBWeFQ7kOCLi97Cr90tDwhRLFlZ7psDuDGvyOCrylQgsGzPY3+xpFj1RZ83tBJ5RHblfY/dybhtO63PyL0Ezs7xqUZuocdrD25MhvkQNT8IckuNp85XCA8KtO6Q2ramK3Z9E8GpelXurg+1pKTcgK37DsdMDoM8ed5e3Y32fOKkPGRsB19R7lyQWt7lGatgX2d/XTGUQNR3soa6vmcCuJx+3O51l+PvRfglXqMYTGUK+h9yxP+W7YY62qBgK3WsO6VjL9DoQ7rNxWFWcWCia0ekUlFNrfPpYOxLxeeKwhsMJqAFJFt9XtGgNl+Lb/qaW2EZcT5j5folNRuhA/tKx2lxnaG5DKI0VFNwXOCPuZtK4xYHwvwjmhN7IhBx24GOcjzqG61f8SE4Ial3T6/hPRKDCXpIg5lSkSmDfKTaPVfywIRKphQVWu70tJC5wUvodOJr5SKyHLiAppNKbMJzNiHRXXJdPUKR6jUZkeyprnN5vHKO8BYfFlufd9NEr9fe5TfDlkXob16A/6qmIlverE8I8xwsCMhBgWhZao/cEt7yn0t5KVEgcmS4INCKL2+2DooOhooGT/76Bk/eebJs6xEIOmQyOrWUG5H9EWp4kZFc0jUFI8JGnXgoef/52ZshHv/bCce9Mtvf+oBlN/5aFm0fIaNPen1MIxLQ=
  - secure: nOfFPluEWau/mb6rLmvcGlqFGaHhybX5I4+83R5ARYdkzIksRPCksjIGPylZ+VYQj/Qy7uBQrp2NvB57C96r4qgux6H+mwASMUPUBZewZwo62PLnIz8o4X4VQGDmqvpl1eZa3rjtPfjOmLAn+MIc/3I/nzJs3uavwkyDmVJAPJ7xkiYkL7TapuH+EOOhIuUS0A8+AuogpX8mLNvd5F2ZIXfOyfruQ0cXPixL37nyJZ/64GlbHqLkrtFdzO+trnH17MwVLWaWZBosuL0qOrPYMVLSDcMfuKYhDxlxX196ubgMY8Lty7VMuxudZknTtzxB+5fX12ENSXU7R3ONUxnGyieO3af8OsRM6LpeggTsRAEEM2Mx2XI/E3ic2XBxdf0EefuMtTMcLX6PKAcdD0yS1oQZpxaZrxdaxb5bGlhix/Xcbp+bRqMZQBcOrX5cYYMBT1YnkzhQ4toCI63aCzwgJda04cepOlt2JPzNgPTuWLBtrdNTLynI8IBWIy4kB3axEldpV7S+e5wq+EGqL+8mzyqaA0W77IPMOXVaGkHRN41NE1wH6135bY7YJfiZD1horAhyklKrlSXDHdLaYHGLI5I3ZpvSKTnQyhIrfKKfI1P/weMLOD2kcc1BW1GnzSWnNIjJXAcSp7zFUfcPgiPsAlp6LIwvL0HICxiNE7NdvU4=
